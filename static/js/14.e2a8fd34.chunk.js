(this["webpackJsonpnextgeneration-storage"]=this["webpackJsonpnextgeneration-storage"]||[]).push([[14],{2425:function(e,n){},2430:function(e,n){},2685:function(e,n,t){"use strict";t.r(n),t.d(n,"OpenloginAdapter",(function(){return w})),t.d(n,"getOpenloginDefaultOptions",(function(){return N}));var i=t(1),r=t.n(i),a=t(13),o=t(5),c=t(6),s=t(11),p=t(37),h=t(32),l=t(8),u=t(9),g=t(293),d=t(12),f=t(17),v=t.n(f),O=t(2469),b=t(182),C=t.n(b),N=function(e,n){return{adapterSettings:{network:g.b.MAINNET,clientId:"",uxMode:g.c.POPUP},chainConfig:e?Object(d.n)(e,n):null,loginSettings:{relogin:!0}}};function k(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);n&&(i=i.filter((function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable}))),t.push.apply(t,i)}return t}function y(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?k(Object(t),!0).forEach((function(n){v()(e,n,t[n])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):k(Object(t)).forEach((function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))}))}return e}var w=function(e){Object(l.a)(i,e);var n=Object(u.a)(i);function i(e){var t,r,a,c;Object(o.a)(this,i),t=n.call(this),v()(Object(s.a)(t),"name",d.j.OPENLOGIN),v()(Object(s.a)(t),"adapterNamespace",d.c.MULTICHAIN),v()(Object(s.a)(t),"type",d.a.IN_APP),v()(Object(s.a)(t),"openloginInstance",null),v()(Object(s.a)(t),"status",d.d.NOT_READY),v()(Object(s.a)(t),"currentChainNamespace",d.g.EIP155),v()(Object(s.a)(t),"openloginOptions",void 0),v()(Object(s.a)(t),"loginSettings",{}),v()(Object(s.a)(t),"privKeyProvider",null),d.p.debug("const openlogin adapter",e);var p=N(null===(r=e.chainConfig)||void 0===r?void 0:r.chainNamespace,null===(a=e.chainConfig)||void 0===a?void 0:a.chainId);if(t.openloginOptions=y(y({clientId:"",network:g.b.MAINNET},p.adapterSettings),e.adapterSettings||{}),t.loginSettings=y(y({},p.loginSettings),e.loginSettings),null!==(c=e.chainConfig)&&void 0!==c&&c.chainNamespace){var h;t.currentChainNamespace=null===(h=e.chainConfig)||void 0===h?void 0:h.chainNamespace;var l=p.chainConfig?p.chainConfig:{};if(t.chainConfig=y(y({},l),null===e||void 0===e?void 0:e.chainConfig),d.p.debug("const openlogin chainConfig",t.chainConfig),!t.chainConfig.rpcTarget)throw d.k.invalidParams("rpcTarget is required in chainConfig")}return t}return Object(c.a)(i,[{key:"chainConfigProxy",get:function(){return this.chainConfig?y({},this.chainConfig):null}},{key:"provider",get:function(){var e;return(null===(e=this.privKeyProvider)||void 0===e?void 0:e.provider)||null},set:function(e){throw new Error("Not implemented")}},{key:"init",value:function(){var e=Object(a.a)(r.a.mark((function e(n){var t,a,o;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(Object(p.a)(Object(h.a)(i.prototype),"checkInitializationRequirements",this).call(this),null!==(t=this.openloginOptions)&&void 0!==t&&t.clientId){e.next=3;break}throw d.k.invalidParams("clientId is required before openlogin's initialization");case 3:if(this.chainConfig||this.currentChainNamespace===d.g.OTHER){e.next=5;break}throw d.k.invalidParams("chainConfig is required before initialization");case 5:return a=!1,this.openloginOptions.uxMode===g.c.REDIRECT&&(o=Object(g.e)(),Object.keys(o).length>0&&o._pid&&(a=!0)),this.openloginOptions=y(y({},this.openloginOptions),{},{replaceUrlOnRedirect:a}),this.openloginInstance=new g.d(this.openloginOptions),d.p.debug("initializing openlogin adapter init"),e.next=12,this.openloginInstance.init();case 12:if(this.status=d.d.READY,this.emit(d.b.READY,d.j.OPENLOGIN),e.prev=14,d.p.debug("initializing openlogin adapter"),!this.openloginInstance.privKey||!n.autoConnect&&!a){e.next=19;break}return e.next=19,this.connect();case 19:e.next=25;break;case 21:e.prev=21,e.t0=e.catch(14),d.p.error("Failed to connect with cached openlogin provider",e.t0),this.emit("ERRORED",e.t0);case 25:case"end":return e.stop()}}),e,this,[[14,21]])})));return function(n){return e.apply(this,arguments)}}()},{key:"connect",value:function(){var e=Object(a.a)(r.a.mark((function e(n){return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return Object(p.a)(Object(h.a)(i.prototype),"checkConnectionRequirements",this).call(this),this.status=d.d.CONNECTING,this.emit(d.b.CONNECTING,y(y({},n),{},{adapter:d.j.OPENLOGIN})),e.prev=3,e.next=6,this.connectWithProvider(n);case 6:return e.abrupt("return",this.provider);case 9:if(e.prev=9,e.t0=e.catch(3),d.p.error("Failed to connect with openlogin provider",e.t0),this.status=d.d.READY,this.emit(d.b.ERRORED,e.t0),null===e.t0||void 0===e.t0||!e.t0.message.includes("user closed popup")){e.next=16;break}throw d.l.popupClosed();case 16:throw d.l.connectionError("Failed to login with openlogin");case 17:case"end":return e.stop()}}),e,this,[[3,9]])})));return function(n){return e.apply(this,arguments)}}()},{key:"disconnect",value:function(){var e=Object(a.a)(r.a.mark((function e(){var n,t=arguments;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.length>0&&void 0!==t[0]?t[0]:{cleanup:!1},this.status===d.d.CONNECTED){e.next=3;break}throw d.l.notConnectedError("Not connected with wallet");case 3:if(this.openloginInstance){e.next=5;break}throw d.k.notReady("openloginInstance is not ready");case 5:return e.next=7,this.openloginInstance.logout();case 7:n.cleanup?(this.status=d.d.NOT_READY,this.openloginInstance=null,this.privKeyProvider=null):this.status=d.d.READY,this.emit(d.b.DISCONNECTED);case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getUserInfo",value:function(){var e=Object(a.a)(r.a.mark((function e(){var n;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.status===d.d.CONNECTED){e.next=2;break}throw d.l.notConnectedError("Not connected with wallet");case 2:if(this.openloginInstance){e.next=4;break}throw d.k.notReady("openloginInstance is not ready");case 4:return e.next=6,this.openloginInstance.getUserInfo();case 6:return n=e.sent,e.abrupt("return",n);case 8:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"setAdapterSettings",value:function(e){if(this.status!==d.d.READY){var n=N();this.openloginOptions=y(y(y({},n.adapterSettings),this.openloginOptions||{}),e)}}},{key:"setChainConfig",value:function(e){Object(p.a)(Object(h.a)(i.prototype),"setChainConfig",this).call(this,e),this.currentChainNamespace=e.chainNamespace}},{key:"connectWithProvider",value:function(){var e=Object(a.a)(r.a.mark((function e(n){var i,a,o,c,s,p,h,l;return r.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(this.chainConfig){e.next=2;break}throw d.k.invalidParams("chainConfig is required before initialization");case 2:if(this.openloginInstance){e.next=4;break}throw d.k.notReady("openloginInstance is not ready");case 4:if(this.currentChainNamespace!==d.g.SOLANA){e.next=12;break}return e.next=7,Promise.all([t.e(1),t.e(2),t.e(15)]).then(t.bind(null,2468));case 7:i=e.sent,a=i.SolanaPrivateKeyProvider,this.privKeyProvider=new a({config:{chainConfig:this.chainConfig}}),e.next=25;break;case 12:if(this.currentChainNamespace!==d.g.EIP155){e.next=20;break}return e.next=15,Promise.all([t.e(3),t.e(24)]).then(t.bind(null,2520));case 15:o=e.sent,c=o.EthereumPrivateKeyProvider,this.privKeyProvider=new c({config:{chainConfig:this.chainConfig}}),e.next=25;break;case 20:if(this.currentChainNamespace!==d.g.OTHER){e.next=24;break}this.privKeyProvider=new O.b,e.next=25;break;case 24:throw new Error("Invalid chainNamespace: ".concat(this.currentChainNamespace," found while connecting to wallet"));case 25:if(this.openloginInstance.privKey||!n){e.next=28;break}return e.next=28,this.openloginInstance.login(C()(this.loginSettings,{loginProvider:n.loginProvider},{extraLoginOptions:y(y({},n.extraLoginOptions||{}),{},{login_hint:n.login_hint||(null===(s=n.extraLoginOptions)||void 0===s?void 0:s.login_hint)})}));case 28:if(!(p=this.openloginInstance.privKey)){e.next=40;break}if(this.currentChainNamespace!==d.g.SOLANA){e.next=36;break}return e.next=33,Promise.all([t.e(1),t.e(16)]).then(t.bind(null,2672));case 33:h=e.sent,l=h.getED25519Key,p=l(p).sk.toString("hex");case 36:return e.next=38,this.privKeyProvider.setupProvider(p);case 38:this.status=d.d.CONNECTED,this.emit(d.b.CONNECTED,{adapter:d.j.OPENLOGIN,reconnected:!n});case 40:case"end":return e.stop()}}),e,this)})));return function(n){return e.apply(this,arguments)}}()}]),i}(d.e)}}]);
//# sourceMappingURL=14.e2a8fd34.chunk.js.map